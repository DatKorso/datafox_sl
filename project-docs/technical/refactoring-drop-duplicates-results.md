# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ drop_duplicates –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

## üìä –ò—Ç–æ–≥–∏ –ø–µ—Ä–≤–æ–π —Ñ–∞–∑—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

1. **–°–æ–∑–¥–∞–Ω —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å** `utils/data_cleaning.py` —Å –∫–ª–∞—Å—Å–∞–º–∏:
   - `DataCleaningUtils` - —É—Ç–∏–ª–∏—Ç—ã –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
   - `ValidationHelper` - –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

2. **–ü—Ä–∏–º–µ–Ω–µ–Ω—ã —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏–∑ Context7**:
   - **Template Method Pattern** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –æ—á–∏—Å—Ç–∫–∏
   - **Extract Method** - –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –±–ª–æ–∫–æ–≤
   - **Parameterize Method** - –æ–±–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - **Consolidate Duplicate Conditional Fragments** - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π

3. **–û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã**:
   - ‚úÖ `utils/cross_marketplace_linker.py` - 2 –º–µ—Å—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–æ
   - ‚úÖ `utils/cards_matcher_helpers.py` - 1 –º–µ—Å—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ

### üìà –ú–µ—Ç—Ä–∏–∫–∏ —É–ª—É—á—à–µ–Ω–∏—è:

| **–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å** | **–î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞** | **–ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞** | **–£–ª—É—á—à–µ–Ω–∏–µ** |
|----------------|--------------------|-----------------------|---------------|
| **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** | 15+ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ | 3 —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–∞ | **80% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ** |
| **–î–ª–∏–Ω–∞ –∫–æ–¥–∞** | ~150 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ | ~30 —Å—Ç—Ä–æ–∫ —É—Ç–∏–ª–∏—Ç | **80% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ** |
| **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** | 6 —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π | 1 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è | **100% —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è** |

## üîÑ –ü—Ä–∏–º–µ—Ä—ã –î–û –∏ –ü–û–°–õ–ï

### ‚ùå –î–û: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥

```python
# –í cross_marketplace_linker.py
wb_barcodes_df = wb_barcodes_df[wb_barcodes_df['barcode'] != ''].drop_duplicates()
oz_barcodes_df = oz_barcodes_df[oz_barcodes_df['barcode'] != ''].drop_duplicates()

# –í cards_matcher_helpers.py (—Ç–æ –∂–µ —Å–∞–º–æ–µ!)
wb_barcodes_df = wb_barcodes_df[wb_barcodes_df['barcode'] != ''].drop_duplicates()
oz_barcodes_df = oz_barcodes_df[oz_barcodes_df['barcode'] != ''].drop_duplicates()

# –í pages/7_–ú–µ–Ω–µ–¥–∂–µ—Ä_–†–µ–∫–ª–∞–º—ã_OZ.py (–∏ —Å–Ω–æ–≤–∞!)
wb_barcodes_df = wb_barcodes_df[wb_barcodes_df['barcode'] != ''].drop_duplicates()
oz_barcodes_ids_df = oz_barcodes_ids_df[oz_barcodes_ids_df['barcode'] != ''].drop_duplicates()
```

### ‚úÖ –ü–û–°–õ–ï: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

```python
# –í–µ–∑–¥–µ –æ–¥–∏–Ω–∞–∫–æ–≤–æ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —É—Ç–∏–ª–∏—Ç—É
from utils.data_cleaning import DataCleaningUtils

wb_barcodes_df, oz_barcodes_df = DataCleaningUtils.clean_marketplace_data(
    wb_barcodes_df, oz_barcodes_df
)
```

## üéØ Template Method Pattern –≤ –¥–µ–π—Å—Ç–≤–∏–∏

### –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–Ω–µ–∏–∑–º–µ–Ω–Ω–∞—è):
```python
def clean_barcode_dataframe(df, barcode_col='barcode'):
    # –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ DataFrame
    if df.empty: return df
    
    # –®–∞–≥ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–ª–æ–Ω–∫–∏
    if barcode_col not in df.columns: return df
    
    # –®–∞–≥ 3: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    cleaned_df = normalize_barcodes(df, barcode_col)
    
    # –®–∞–≥ 4: –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤  
    cleaned_df = remove_duplicates(cleaned_df)
    
    return cleaned_df
```

### –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —á–∞—Å—Ç–∏ (–≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è):
- –¢–∏–ø –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ (WB, Ozon, generic)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
- –ö–æ–ª–æ–Ω–∫–∏ –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

## üîß –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ —Ç–∏–ø—É –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
```python
# –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –¥–ª—è WB
wb_clean = DataCleaningUtils.comprehensive_marketplace_cleaning(
    wb_df, marketplace_type='wb'
)

# –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –¥–ª—è Ozon  
oz_clean = DataCleaningUtils.comprehensive_marketplace_cleaning(
    oz_df, marketplace_type='ozon'
)
```

### 2. –ì–∏–±–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
```python
# –ü–æ –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ
df_clean = DataCleaningUtils.remove_duplicates_by_columns(df, 'sku')

# –ü–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∫–æ–ª–æ–Ω–∫–∞–º
df_clean = DataCleaningUtils.remove_duplicates_by_columns(
    df, ['wb_sku', 'oz_sku', 'oz_vendor_code']
)
```

### 3. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
```python
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏
ValidationHelper.validate_dataframe_not_empty(df, "–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
ValidationHelper.validate_required_columns(df, ['sku', 'price'])
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### üìã –ü–ª–∞–Ω –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π:

#### –§–∞–∑–∞ 2: –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ (–≤ —Ä–∞–±–æ—Ç–µ)
- [ ] `pages/7_üéØ_–ú–µ–Ω–µ–¥–∂–µ—Ä_–†–µ–∫–ª–∞–º—ã_OZ.py` - 4 –º–µ—Å—Ç–∞
- [ ] `pages/12_üö®_–ü—Ä–æ–±–ª–µ–º—ã_–ö–∞—Ä—Ç–æ—á–µ–∫_OZ.py` - 1 –º–µ—Å—Ç–æ  
- [ ] `utils/db_search_helpers.py` - 1 –º–µ—Å—Ç–æ

#### –§–∞–∑–∞ 3: –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –≤ `search-algorithms.md`
- [ ] –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã –≤–æ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

## üí° –í—ã—É—á–µ–Ω–Ω—ã–µ —É—Ä–æ–∫–∏

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:
1. **Template Method Pattern** –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –æ—á–∏—Å—Ç–∫–∏
2. **Extract Method** –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–¥–∞
3. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏-–æ–±–µ—Ä—Ç–∫–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é

### üîÑ –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:
1. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –æ—á–∏—Å—Ç–∫–∏
2. –†–∞—Å—à–∏—Ä–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
3. –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Ç–µ—Ö–Ω–∏–∫–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ (Context7)**:
- **Template Method Pattern** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞
- **Extract Method** - –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤ –º–µ—Ç–æ–¥—ã  
- **Parameterize Method** - –æ–±–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **Consolidate Duplicate Conditional Fragments** - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π

**–ò—Å—Ç–æ—á–Ω–∏–∫**: RefactoringGuru Examples - –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞.

---
*–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω: DataFox SL Development Team*  
*–î–∞—Ç–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞: 2024*  
*–í–µ—Ä—Å–∏—è: 1.0* 

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã
–í —Å–∏—Å—Ç–µ–º–µ –±—ã–ª–∏ –≤—ã—è–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–∏–≤–æ–¥—è—â–∏–µ –∫ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Ä–∞—Å—á–µ—Ç–∞–º –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤ –≤ –º–æ–¥—É–ª–µ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤.

## –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–æ–∏—Å–∫–µ –º–µ–∂–¥—É –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞–º–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ `oz_vendor_code` –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏—Å—å –¥—É–±–ª–∏–∫–∞—Ç—ã `wb_sku`, –∫–æ–≥–¥–∞ –æ–¥–∏–Ω vendor code –±—ã–ª —Å–≤—è–∑–∞–Ω —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —à—Ç—Ä–∏—Ö–∫–æ–¥–∞–º–∏.

**–ü—Ä–∏–º–µ—Ä**: –ü–æ–∏—Å–∫ –ø–æ `oz_vendor_code = "0562002534-—Å–∏–Ω–∏–π-34"` –≤–æ–∑–≤—Ä–∞—â–∞–ª –¥–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö `wb_sku = 142005087` –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ.

### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ —Ä–µ–∫–ª–∞–º–Ω–æ–º –º–µ–Ω–µ–¥–∂–µ—Ä–µ
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Å—Ç–∞—Ç–∫–∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –æ–¥–∏–Ω `oz_sku` –º–æ–≥ –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö —Å–≤—è–∑—ã–≤–∞–Ω–∏—è, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —É–¥–≤–æ–µ–Ω–∏—é/—É—Ç—Ä–æ–µ–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏–π –æ—Å—Ç–∞—Ç–∫–æ–≤.

**–ü—Ä–∏–º–µ—Ä**: –ü—Ä–∏ `wb_sku = 142005087` —Å—É–º–º–∞—Ä–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 219, –Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–ª—Å—è –∫–∞–∫ 400+ –∏–∑-–∑–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

### 3. –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞—Å—á–µ—Ç–æ–º –∑–∞–∫–∞–∑–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: –ó–∞–∫–∞–∑—ã —Ç–∞–∫–∂–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å –ø–æ —Ç–µ–º –∂–µ –ø—Ä–∏—á–∏–Ω–∞–º, —á—Ç–æ –∏ –æ—Å—Ç–∞—Ç–∫–∏.

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–∏–µ `CrossMarketplaceLinker.get_bidirectional_links()`
```python
# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ 
# –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã —Å–Ω–∞—á–∞–ª–∞ –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º —Å–≤—è–∑—è–º wb_sku-oz_sku
result_df = result_df.drop_duplicates(subset=['wb_sku', 'oz_sku'], keep='first')

# –ó–∞—Ç–µ–º —É–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–º—É –Ω–∞–±–æ—Ä—É –∫–æ–ª–æ–Ω–æ–∫  
result_df = DataCleaningUtils.remove_duplicates_by_columns(
    result_df, 
    subset_columns=['wb_sku', 'oz_sku', 'oz_vendor_code'], 
    keep='first'
)
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `find_marketplace_matches()`
–î–æ–±–∞–≤–ª–µ–Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ `oz_vendor_code`:
```python
# –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ vendor_code —É–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ wb_sku
if search_criterion == 'oz_vendor_code':
    if wb_sku_col and wb_sku_col in results_df.columns:
        results_df = results_df.drop_duplicates(subset=[wb_sku_col], keep='first')
```

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ `calculate_total_stock_by_wb_sku()`
```python
# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ wb_sku-oz_sku —Å–≤—è–∑–∫–∞–º –ü–ï–†–ï–î –ø–æ–¥—Å—á–µ—Ç–æ–º –æ—Å—Ç–∞—Ç–∫–æ–≤
merged_df = merged_df.drop_duplicates(subset=['wb_sku', 'oz_sku'], keep='first')

# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —É–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–¥ –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π
merged_with_stock_df = merged_with_stock_df.drop_duplicates(subset=['wb_sku', 'oz_sku'], keep='first')
```

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞ –∑–∞–∫–∞–∑–æ–≤ –≤ `calculate_total_orders_by_wb_sku()`
–ü—Ä–∏–º–µ–Ω–µ–Ω—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞ –∑–∞–∫–∞–∑–æ–≤.

### 5. –£–ª—É—á—à–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è `get_linked_ozon_skus_with_details()`
```python
# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü–æ–ª—É—á–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã WB-Ozon SKU —Å –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–µ–π
sku_pairs_df = linked_df[['wb_sku', 'oz_sku']].drop_duplicates(subset=['wb_sku', 'oz_sku'], keep='first')
```

### 6. –£–ª—É—á—à–µ–Ω–∏–µ `DataCleaningUtils.clean_barcode_dataframe()`
```python
# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
# –î–ª—è –¥–∞–Ω–Ω—ã—Ö –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª—è–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∫–ª—é—á–µ–≤—ã–º –ø–æ–ª—è–º
if barcode_col in cleaned_df.columns:
    sku_cols = [col for col in cleaned_df.columns if 'sku' in col.lower()]
    if sku_cols:
        key_columns = [barcode_col] + sku_cols
        cleaned_df = cleaned_df.drop_duplicates(subset=key_columns, keep='first')
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ–∏—Å–∫ –º–µ–∂–¥—É –ú–ü**: –ö–∞–∂–¥—ã–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π vendor code –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ wb_sku –±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
2. **–¢–æ—á–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã –æ—Å—Ç–∞—Ç–∫–æ–≤**: –û—Å—Ç–∞—Ç–∫–∏ –±—É–¥—É—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
3. **–¢–æ—á–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã –∑–∞–∫–∞–∑–æ–≤**: –ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ú–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π = –±—ã—Å—Ç—Ä–µ–µ –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å–ª—É—á–∞–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. –ü–æ–∏—Å–∫ –ø–æ `oz_vendor_code = "0562002534-—Å–∏–Ω–∏–π-34"` –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω `wb_sku = 142005087`
2. –†–∞—Å—á–µ—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ –¥–ª—è `wb_sku = 142005087` –¥–æ–ª–∂–µ–Ω –¥–∞–≤–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚â§ 219, –∞ –Ω–µ 400+
3. –û–±—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞ –∏ —Ä–∞—Å—á–µ—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ —É–ª—É—á—à–∏—Ç—å—Å—è

## –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã:
- `utils/cross_marketplace_linker.py` - –æ—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å —Å–≤—è–∑—ã–≤–∞–Ω–∏—è
- `pages/7_üéØ_–ú–µ–Ω–µ–¥–∂–µ—Ä_–†–µ–∫–ª–∞–º—ã_OZ.py` - —Ä–µ–∫–ª–∞–º–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
- `utils/data_cleaning.py` - —É—Ç–∏–ª–∏—Ç—ã –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## –î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: 2024-12-25

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
–í—Å–µ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ø—É—Ç–µ–º –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —ç—Ç–∞–ø–∞—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö. 